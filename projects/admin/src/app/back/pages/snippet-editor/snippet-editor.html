<form [formGroup]="form">

    <h6 class="mt-1"><i class="bi bi-gear-fill me-2"></i>Contenu</h6>
    <div class="row">
        <div class="col-8">
            <label class="form-label form-label-sm mb-0">Titre</label>
            <input type="text" formControlName="title" class="form-control form-control-sm mb-1"
                (keyup.enter)="onEnterSave($event)">
            <label class="form-label form-label-sm mb-0">Sous-titre</label>
            <input type="text" formControlName="subtitle" class="form-control form-control-sm text-muted mb-1"
                (keyup.enter)="onEnterSave($event)">
        </div>
        <div class="col-4 text-center">
            <img *ngIf="form.get('image')?.value" [src]="snippet?.image_url || form.get('image')?.value"
                alt="{{ form.get('title')?.value }}" class="img-fluid snippet-img-limited">
        </div>
    </div>

    <div class="form-label text-muted mb-0 mt-2">
        <button type="button" class="btn btn-sm btn-outline-success " (click)="snippet && onSnippetContentClick(snippet)">
            <i class="bi bi-arrows-fullscreen"></i> Éditeur texte </button>
    </div>

    <h6 class="mt-3"><i class="bi bi-gear-fill me-2"></i>Paramètres de publication</h6>

    <div class="mt-2 d-flex flex-row align-items-center gap-3">
        <span class="form-label text-muted mb-0">Publié le (sinon aujourd'hui):</span>
        <input type="date" formControlName="publishedAt" class="form-control form-control-sm d-inline-block w-auto"
            (keydown.enter)="saveSnippetSelected()" (change)="saveSnippetSelected()" placeholder="publication">
    </div>

    <div class="mt-2 d-flex flex-row align-items-center gap-3">
        <div class="form-check form-switch mb-0 d-flex flex-row align-items-center">
            <input [formControlName]="'public'" (change)="onToggleChange('public', $event.target.checked)"
                [ngClass]="form.get('public')?.value ? 'bg-success' : 'bg-light'" class="form-check-input"
                style="width: 3em; height: 1.5em;" type="checkbox" role="switch">
            <label class="form-check-label text-muted ms-2">Public</label>
        </div>
        <div class="form-check form-switch mb-0 d-flex flex-row align-items-center">
            <input [formControlName]="'featured'" (change)="onToggleChange('featured', $event.target.checked)"
                [ngClass]="form.get('featured')?.value ? 'bg-success' : 'bg-light'" class="form-check-input"
                style="width: 3em; height: 1.5em;" type="checkbox" role="switch">
            <label class="form-check-label text-muted ms-2">à la une</label>
        </div>
    </div>

    <h6 class="mt-3"><i class="bi bi-gear-fill me-2"></i>Fichiers associés</h6>

    <!-- image url input with embedded file system selector -->
    <div class="form-label mb-0 mt-2">
        Illustration :
        <span class="form-text">
            {{ form.get('image')?.value ? getNameFromPath(form.get('image')?.value) : 'aucune image' }}
        </span>
        <button type="button" class="btn btn-sm ms-1" (click)="showImageSelector = !showImageSelector">
            <i class="h5 bi-folder2-open text-success"></i>
        </button>
        <ng-container *ngIf="showImageSelector">
            <app-file-system-selector
                [rootFolder]="S3_ROOT_FOLDERS.IMAGES + '/'"
                mode="files"
                [allowCreateFolder]="false"
                [selectOnFolderClick]="false"
                [allowActions]="false"
                (select)="form.get('image')?.setValue($event); showImageSelector = false">
            </app-file-system-selector>
        </ng-container>
    </div>


    <!-- file url input with embedded file system selector -->
    <div class="form-label mb-0 mt-2">
        Fichier à télécharger :
        <span class="form-text">
            {{ form.get('file')?.value ? getNameFromPath(form.get('file')?.value) : 'aucun fichier' }}
        </span>
        <button type="button" class="btn btn-sm ms-1" (click)="showFileSelector = !showFileSelector">
            <i class="h5 bi-folder2-open text-success"></i>
        </button>
        <ng-container *ngIf="showFileSelector">
            <app-file-system-selector
                [rootFolder]="S3_ROOT_FOLDERS.DOCUMENTS + '/'"
                mode="files"
                [allowCreateFolder]="false"
                [selectOnFolderClick]="false"
                [allowActions]="false"
                (select)="form.get('file')?.setValue($event); showFileSelector = false">
            </app-file-system-selector>
        </ng-container>
    </div>


    <!-- folder selector (albums) with embedded file system selector -->
    <div class="form-label mb-0 mt-2">
        Album photo :
        <span class="form-text">
            {{ form.get('folder')?.value ? getNameFromPath(form.get('folder')?.value) : 'aucun dossier' }}
        </span>
        <button type="button" class="btn btn-sm ms-1" (click)="showFolderSelector = !showFolderSelector">
            <i class="h5 bi-folder2-open text-success"></i>
        </button>
        <ng-container *ngIf="showFolderSelector">
            <app-file-system-selector
                [rootFolder]="S3_ROOT_FOLDERS.ALBUMS + '/'"
                mode="folders"
                [allowCreateFolder]="true"
                [selectOnFolderClick]="true"
                [allowActions]="false"
                (select)="form.get('folder')?.setValue($event); showFolderSelector = false">
            </app-file-system-selector>
        </ng-container>
    </div>
    
</form>