<div class="container mt-4" style="max-width: 800px;">
	<h3>Envoi d'email aux membres</h3>
	<form (ngSubmit)="sendMail()" #mailForm="ngForm">
		<div class="mb-3">
			<label>ExpÃ©diteur (from)</label>
			<input class="form-control" [(ngModel)]="from" name="from" required>
		</div>
		<div class="mb-3">
			<label>Destinataires (sÃ©parÃ©s par virgule)</label>
			<input class="form-control" [(ngModel)]="toList" name="toList" required>
		</div>
		<div class="mb-3">
			<label>Sujet</label>
			<input class="form-control" [(ngModel)]="subject" name="subject" required>
		</div>
		
		<!-- Toggle HTML / Texte -->
		<div class="mb-3">
			<div class="form-check form-switch">
				<input class="form-check-input" type="checkbox" id="useHtml" [(ngModel)]="useHtml" name="useHtml">
				<label class="form-check-label" for="useHtml">
					Utiliser le format HTML (avec en-tÃªte et footer automatiques)
				</label>
			</div>
		</div>
		
		<!-- Ã‰diteur HTML -->
		<div class="mb-3" *ngIf="useHtml">
			<label>Contenu HTML (sera insÃ©rÃ© dans le template avec en-tÃªte et footer)</label>
			<div class="alert alert-info small">
				ğŸ’¡ Vous pouvez coller du HTML formatÃ© ici. Il sera automatiquement encadrÃ© par l'en-tÃªte du club et le footer avec le lien de dÃ©sinscription.
			</div>
			<textarea class="form-control font-monospace" [(ngModel)]="bodyHtml" name="bodyHtml" rows="12" required
				placeholder="<p>Bonjour,</p>
<p>Voici le contenu de votre message...</p>
<ul>
  <li>Point 1</li>
  <li>Point 2</li>
</ul>"></textarea>
			
			<!-- PrÃ©visualisation -->
			<details class="mt-2">
				<summary class="btn btn-sm btn-outline-secondary">PrÃ©visualiser le rendu HTML</summary>
				<div class="border p-3 mt-2" [innerHTML]="bodyHtml" style="background-color: #f9f9f9;"></div>
			</details>
		</div>
		
		<!-- Ã‰diteur texte simple -->
		<div class="mb-3" *ngIf="!useHtml">
			<label>Message (texte brut)</label>
			<textarea class="form-control" [(ngModel)]="body" name="body" rows="8" required></textarea>
		</div>
		
		<button class="btn btn-success" [disabled]="sending || !mailForm.form.valid">
			<span *ngIf="sending" class="spinner-border spinner-border-sm me-2"></span>
			Envoyer
		</button>
	</form>
	<div *ngIf="result" class="alert alert-success mt-3">
		âœ… Envoi rÃ©ussi ! {{ result.sentCount }} email(s) envoyÃ©(s).
	</div>
	<div *ngIf="error" class="alert alert-danger mt-3">âŒ Erreur : {{ error }}</div>
</div>
