<div class="container-fluid bg-light p-0 m-0 w-100" style="max-width:100vw;">
  <div class="d-flex d-inline align-items-start w-100 bg-dark px-2 pt-1 pb-1 position-relative">
    <!-- Mobile sidebar toggle button -->
    <button *ngIf="(logged_member$ | async)" class="btn btn-outline-secondary d-md-none text-center" type="button"
      data-bs-toggle="offcanvas" data-bs-target="#mobileSidebar" aria-controls="mobileSidebar">
      <i class="bi bi-list text-start"></i>
    </button>


    <span class="d-none d-md-inline logo-overlap" style="margin-right:0.5em;">
      <img src="admin.jpg" alt="BCSTO logo" class="me-1 logo-navbar" style="height:2.7em;max-height:56px;width:auto;vertical-align:top;display:block;" />
    </span>

    <span class="d-none d-md-inline fs-5 ms-1" style="padding-left:1em;">
      Bridge Club <span style="white-space:nowrap">Saint-Orens</span>
      - saison {{season}}
      <span class="badge bg-success" style="font-size: 0.6rem;">{{entries_nbr}}</span>
      <span *ngIf="!production_mode" class="badge bg-dark" style="font-size: 0.6rem;">dev</span>
    </span>

    <span class="d-sm-inline d-md-none fs-5 ms-1">BCSTO {{season}}</span>

    <!-- backdoor to front -->
    <div class="d-flex ms-auto align-items-end me-2">
      <span class=" ms-4 d-none d-sm-inline ">
        <a [routerLink]="'/front'">
          <i class="bi bi-door-open-fill "></i>
        </a>
      </span>
    </div>
  </div>

  <!-- Desktop navigation -->
  <nav class="navbar navbar-expand-md navbar-light bg-light shadow-sm d-none d-md-block w-100" style="padding-left:0;">
    <div class="navbar-collapse d-flex" style="padding-left:0;">
      <!-- <ul class="navbar-nav me-auto mb-md-0 mb-lg-0 align-items-start menu-sm-tight">
      </ul> -->
      <ul class="navbar-nav mb-md-0 mb-lg-0 mt-2 align-items-end" style="padding-left:0;">

        <li class="nav-item" *ngIf="accreditation_level >= accreditation_levels.Contributeur">
          <a class="nav-link" routerLink="./caisse/droits-de-table">
            <i class="bi bi-card-checklist"></i>
            <span class="ms-1">Tournois</span>
          </a>
        </li>

        <li *ngIf="accreditation_level >= accreditation_levels.Contributeur" ngbDropdown
          class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-cart"></i> <span class="ms-1">Boutique</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./caisse/ventes">vente à adhérents</a></li>
            <li><a class="dropdown-item" routerLink="./caisse/produits">produits à la vente</a></li>
          </ul>
        </li>

        <li *ngIf="accreditation_level >= accreditation_levels.Contributeur" ngbDropdown
          class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-people"></i>
            <span class="ms-1">Adhérents</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./members/database">répertoire</a></li>
            <li *ngIf="accreditation_level >= accreditation_levels.Administrateur"><a class="dropdown-item"
                routerLink="./members/cartes-admission">cartes admission</a></li>
            <li><a class="dropdown-item" routerLink="./members/controls">contrôles</a></li>
          </ul>
        </li>


        <li *ngIf="accreditation_level >= accreditation_levels.Administrateur" ngbDropdown
          class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-journal"></i> <span class="ms-1">Finance</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./finance/état-de-caisse">état de caisse</a></li>
            <li><a class="dropdown-item" routerLink="./finance/toutes-ecritures">écritures</a></li>
            <li><a class="dropdown-item" routerLink="./finance/books/base-comptable">synthèse</a></li>
            <li><a class="dropdown-item" routerLink="./finance/bank-reconciliation">rapprochement bancaire</a></li>
            <li><a class="dropdown-item" routerLink="./finance/expense-and-revenue">résultats</a></li>
            <li><a class="dropdown-item" routerLink="./finance/balance">bilan</a></li>
          </ul>
        </li>

        <!-- Outils -->
        <li *ngIf="accreditation_level >= accreditation_levels.Systeme" ngbDropdown
          class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-database-fill-gear"></i> <span class="ms-1">Outils</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./finance/books/list">base de données</a></li>
            <li><a class="dropdown-item" routerLink="./finance/books/editor">écriture</a></li>
            <li><a class="dropdown-item" routerLink="./outils/groups">droits d'accès</a></li>
            <li><a class="dropdown-item" routerLink="./outils/sysconf">configuration</a></li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/disk">données S3</a></li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/excel_import">import excel</a>
            </li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/cloneDB">clone DB</a></li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/cloneS3">clone S3</a></li>
          </ul>
        </li>

        <!-- site -->
        <li *ngIf="accreditation_level >= accreditation_levels.Editeur" ngbDropdown
          class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-globe2"></i> <span class="ms-1">Site web</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <!-- <li><a class="dropdown-item" routerLink="./site/thumbnails">vignettes</a></li> -->
            <li><a class="dropdown-item" routerLink="./site/ui">paramètres UI</a></li>
            <li ><a class="dropdown-item" routerLink="./site/menus">les menus</a></li>
            <li><a class="dropdown-item" routerLink="./site/pages">les pages</a></li>
            <li><a class="dropdown-item" routerLink="./site/uploader">les datas</a></li>
            <li><a class="dropdown-item" routerLink="./site/cms-wrapper">CMS Wrapper</a></li>
            <li><a class="dropdown-item" routerLink="/front">aller sur le site</a></li>
          </ul>
        </li>

        <!-- Assistance -->
        <li class="nav-item" *ngIf="(accreditation_level >= accreditation_levels.Editeur) && (assistances_nbr > 0)">
          <a class="nav-link" routerLink="./assistance">
            <i class="bi bi-person-raised-hand">
              <span  class="badge bg-warning top-0 start-100 translate-middle"
                style="font-size: 0.6rem;">{{assistances_nbr}}</span>
            </i>
            <span class="ms-0">Assistance</span>
          </a>
        </li>

        <!-- Mailing -->
        <li class="nav-item" *ngIf="(accreditation_level >= accreditation_levels.Administrateur)">
          <a class="nav-link" routerLink="./mailing">
            <i class="bi bi-envelope-fill">
            </i>
            <span class="ms-0">Mailing</span>
          </a>
        </li>


        <li *ngIf="(logged_member$ | async) as member" class="nav-item dropdown ms-auto me-5" ngbDropdown>
          <a class="nav-link dropdown-toggle d-flex align-items-center" ngbDropdownToggle href="#">
            <ng-container *ngIf="member.has_avatar; else defaultIcon">
              <img [src]="avatar$ | async" alt="avatar" class="rounded-circle align-self-center"
                style="width:20px; height:20px; max-width:20px; max-height:20px; object-fit:cover;">
            </ng-container>
            <ng-template #defaultIcon>
              <i class="bi bi-person-circle align-self-center"></i>
            </ng-template>
            <span class="ms-1 align-self-center">{{ member.firstname }}</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li> <a class="dropdown-item" (click)="signOut()">
                <i class="bi bi-box-arrow-right"></i>
                Déconnexion
              </a></li>
          </ul>
        </li>

      </ul>
    </div>
  </nav>

  <!-- Mobile sidebar (offcanvas) -->
  <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="mobileSidebar"
    aria-labelledby="mobileSidebarLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="mobileSidebarLabel">Back office</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
      <ul class="navbar-nav menu-sm-tight">


        <!-- Copy of the navigation menu for mobile -->

        <!-- Tournoi (single item) -->
        <li class="nav-item" *ngIf="accreditation_level >= accreditation_levels.Contributeur">
          <a class="nav-link d-flex align-items-center" routerLink="./caisse/droits-de-table"
            data-bs-dismiss="offcanvas">
            <i class="bi bi-card-checklist"></i>
            <span class="ms-1">Tournois</span>
          </a>
        </li>

        <li *ngIf="accreditation_level >= accreditation_levels.Contributeur" ngbDropdown class="nav-item dropdown">
          <div class="d-flex align-items-center">
            <span class="nav-link p-0 pe-2" style="cursor:default;">
              <i class="bi bi-cart"></i> <span class="ms-1">Boutique</span>
            </span>
            <a class="nav-link dropdown-toggle p-0" ngbDropdownToggle href="#" style="width:2em;"></a>
          </div>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./caisse/ventes" data-bs-dismiss="offcanvas">vente à adhérents</a>
            </li>
            <li><a class="dropdown-item" routerLink="./caisse/produits" data-bs-dismiss="offcanvas">produits à la
                vente</a></li>
          </ul>
        </li>
        <li *ngIf="accreditation_level >= accreditation_levels.Contributeur" ngbDropdown class="nav-item dropdown">
          <div class="d-flex align-items-center">
            <span class="nav-link p-0 pe-2" style="cursor:default;">
              <i class="bi bi-people"></i> <span class="ms-1">Adhérents</span>
            </span>
            <a class="nav-link dropdown-toggle p-0" ngbDropdownToggle href="#" style="width:2em;"></a>
          </div>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./members/database" data-bs-dismiss="offcanvas">répertoire</a></li>
            <li><a class="dropdown-item" routerLink="./members/cartes-admission" data-bs-dismiss="offcanvas">cartes
                admission</a></li>
            <li><a class="dropdown-item" routerLink="./members/controls" data-bs-dismiss="offcanvas">contrôles</a></li>
          </ul>
        </li>
        <li *ngIf="accreditation_level >= accreditation_levels.Administrateur" ngbDropdown class="nav-item dropdown">
          <div class="d-flex align-items-center">
            <span class="nav-link p-0 pe-2" style="cursor:default;">
              <i class="bi bi-journal"></i> <span class="ms-1">Finance</span>
            </span>
            <a class="nav-link dropdown-toggle p-0" ngbDropdownToggle href="#" style="width:2em;"></a>
          </div>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./finance/état-de-caisse" data-bs-dismiss="offcanvas">état de
                caisse</a></li>
            <li><a class="dropdown-item" routerLink="./finance/toutes-ecritures" data-bs-dismiss="offcanvas">écritures
              </a></li>
            <li><a class="dropdown-item" routerLink="./finance/books/base-comptable"
                data-bs-dismiss="offcanvas">synthèse</a></li>
            <li><a class="dropdown-item" routerLink="./finance/bank-reconciliation"
                data-bs-dismiss="offcanvas">rapprochement bancaire</a></li>
            <li><a class="dropdown-item" routerLink="./finance/expense-and-revenue"
                data-bs-dismiss="offcanvas">résultats</a></li>
            <li><a class="dropdown-item" routerLink="./finance/balance" data-bs-dismiss="offcanvas">bilan</a></li>
          </ul>
        </li>
        <li *ngIf="accreditation_level >= accreditation_levels.Systeme" ngbDropdown class="nav-item dropdown">
          <div class="d-flex align-items-center">
            <span class="nav-link p-0 pe-2" style="cursor:default;">
              <i class="bi bi-database-fill-gear"></i> <span class="ms-1">Outils</span>
            </span>
            <a class="nav-link dropdown-toggle p-0" ngbDropdownToggle href="#" style="width:2em;"></a>
          </div>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./finance/books/list" data-bs-dismiss="offcanvas">base de
                données</a></li>
            <li><a class="dropdown-item" routerLink="./finance/books/editor" data-bs-dismiss="offcanvas">écriture</a>
            </li>
            <li><a class="dropdown-item" routerLink="./outils/groups" data-bs-dismiss="offcanvas">droits d'accès</a>
            </li>
            <li><a class="dropdown-item" routerLink="./outils/sysconf" data-bs-dismiss="offcanvas">configuration</a>
            </li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/excel_import"
                data-bs-dismiss="offcanvas">import excel</a></li>
            <li *ngIf="!production_mode"><a class="dropdown-item" routerLink="./outils/cloneDB"
                data-bs-dismiss="offcanvas">clone DB</a></li>
          </ul>
        </li>
        <li *ngIf="accreditation_level >= accreditation_levels.Administrateur" ngbDropdown class="nav-item dropdown">
          <div class="d-flex align-items-center">
            <span class="nav-link p-0 pe-2" style="cursor:default;">
              <i class="bi bi-globe2"></i> <span class="ms-1">Site web</span>
            </span>
            <a class="nav-link dropdown-toggle p-0" ngbDropdownToggle href="#" style="width:2em;"></a>
          </div>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="./site/ui" data-bs-dismiss="offcanvas">paramètres UI</a></li>
            <li ><a class="dropdown-item" routerLink="./site/menus" data-bs-dismiss="offcanvas">les menus</a></li>
            <li><a class="dropdown-item" routerLink="./site/pages" data-bs-dismiss="offcanvas">les pages</a></li>
            <li><a class="dropdown-item" routerLink="./site/uploader" data-bs-dismiss="offcanvas">les datas</a></li>

            <li><a class="dropdown-item" routerLink="/front" data-bs-dismiss="offcanvas">aller sur le site</a></li>
          </ul>
        </li>

       <!-- Assistance -->
        <li class="nav-item ms-md-1 ms-sm-1" *ngIf="accreditation_level >= accreditation_levels.Editeur">
          <a class="nav-link" routerLink="./assistance">
            <i class="bi bi-person-raised-hand">
              <span *ngIf="assistances_nbr > 0" class="badge bg-warning top-0 start-100 translate-middle"
                style="font-size: 0.6rem;">{{assistances_nbr}}</span>
            </i>
            <span class="ms-0">Assistance</span>
          </a>
        </li>

        <li *ngIf="(logged_member$ | async) " ngbDropdown class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" ngbDropdownToggle href="#">
            <i class="bi bi-person-circle"></i>
            <span class="ms-1">{{ (logged_member$ | async)?.firstname }}</span>
          </a>
          <ul ngbDropdownMenu class="dropdown-menu">
            <li> <a class="dropdown-item" (click)="signOut()" data-bs-dismiss="offcanvas">
                <i class="bi bi-box-arrow-right"></i>
                Déconnexion
              </a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>

</div>